<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exploring the Popularity of Spotify Tracks – The popularity of songs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-c75bcb89907db7808f0349b764a1a524.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The popularity of songs</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Using Supervised Machine Learning and Data Visualization</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#which-genres-are-dominating-and-when-have-been-the-tracks-released" id="toc-which-genres-are-dominating-and-when-have-been-the-tracks-released" class="nav-link active" data-scroll-target="#which-genres-are-dominating-and-when-have-been-the-tracks-released">Which genres are dominating and when have been the tracks released?</a></li>
  <li><a href="#how-are-the-features-connected-to-each-other" id="toc-how-are-the-features-connected-to-each-other" class="nav-link" data-scroll-target="#how-are-the-features-connected-to-each-other">How are the features connected to each other?</a>
  <ul class="collapse">
  <li><a href="#how-are-danceability-and-energy-are-connected" id="toc-how-are-danceability-and-energy-are-connected" class="nav-link" data-scroll-target="#how-are-danceability-and-energy-are-connected">How are danceability and energy are connected?</a></li>
  <li><a href="#which-role-plays-the-tempo-for-danceability-and-energy" id="toc-which-role-plays-the-tempo-for-danceability-and-energy" class="nav-link" data-scroll-target="#which-role-plays-the-tempo-for-danceability-and-energy">Which role plays the tempo for danceability and energy?</a></li>
  <li><a href="#how-do-each-of-the-features-correlate-with-each-other" id="toc-how-do-each-of-the-features-correlate-with-each-other" class="nav-link" data-scroll-target="#how-do-each-of-the-features-correlate-with-each-other">How do each of the features correlate with each other?</a></li>
  </ul></li>
  <li><a href="#is-there-a-secret-receipt-for-a-tracks-popularity" id="toc-is-there-a-secret-receipt-for-a-tracks-popularity" class="nav-link" data-scroll-target="#is-there-a-secret-receipt-for-a-tracks-popularity">Is there a secret receipt for a tracks’ popularity?</a>
  <ul class="collapse">
  <li><a href="#the-distribution-of-popularity" id="toc-the-distribution-of-popularity" class="nav-link" data-scroll-target="#the-distribution-of-popularity">The distribution of popularity</a></li>
  <li><a href="#is-very-happy-sad-or-angry-music-more-popular-visualizing-the-influence-of-valence-on-popularity" id="toc-is-very-happy-sad-or-angry-music-more-popular-visualizing-the-influence-of-valence-on-popularity" class="nav-link" data-scroll-target="#is-very-happy-sad-or-angry-music-more-popular-visualizing-the-influence-of-valence-on-popularity">Is very happy, sad or angry music more popular? Visualizing the influence of valence on popularity</a></li>
  <li><a href="#what-features-are-important-for-the-popularity" id="toc-what-features-are-important-for-the-popularity" class="nav-link" data-scroll-target="#what-features-are-important-for-the-popularity">What features are important for the popularity?</a>
  <ul class="collapse">
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear regression</a></li>
  </ul></li>
  <li><a href="#tuning-linear-regressions-and-model-fit" id="toc-tuning-linear-regressions-and-model-fit" class="nav-link" data-scroll-target="#tuning-linear-regressions-and-model-fit">Tuning Linear Regressions and Model Fit</a></li>
  <li><a href="#beyond-linearity" id="toc-beyond-linearity" class="nav-link" data-scroll-target="#beyond-linearity">Beyond linearity</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exploring the Popularity of Spotify Tracks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>What makes a song popular in todays world? Is there a secret receipt for success? In this project I investigate these and further questions using a open source data set of Spotify tracks.</p>
<p><strong>About the <a href="https://www.kaggle.com/datasets/solomonameh/spotify-music-dataset/data">data set</a></strong>: The dataset is collated from Spotify’s API using two separate python scripts to extract popular and non-popular songs and their associated audio and descriptive features. Descriptive features of a song include information about the song such as the artist name, album name and release date. Audio features include key, valence, danceability and energy which are results of spotify’s audio analysis.</p>
<p><strong>Step 1. Load the libraries</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#renv::install("ISLR")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse) <span class="co">#basic</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble) <span class="co">#tibble</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#ggplot</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra) <span class="co">#for marginal histograms and more</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel) <span class="co">#label for graphs</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot) <span class="co"># for ggpcorrpltos</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggthemes)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridis)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(viridisLite)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) <span class="co">#palettes for high readability and accessibility for visualisations</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="co"># for tables</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggsurvey)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtExtras) <span class="co"># for tables</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(webshot2) <span class="co"># save gt tables as png</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table) <span class="co">#transpose data frames</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(extrafont) <span class="co"># for extra fonts</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co">#dates to numeric</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(showtext) <span class="co">#for adding fonts</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co">#train test data set</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmnet) <span class="co"># for ridge regression</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR) <span class="co"># for splines and polys</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">loadfonts</span>(<span class="at">device=</span><span class="st">"win"</span>, <span class="at">quiet=</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">font_add_google</span>(<span class="at">name=</span><span class="st">"Barlow"</span>, <span class="at">family=</span><span class="st">"Barlow"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">showtext_auto</span>()</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">"scipen"</span><span class="ot">=</span><span class="dv">100</span>, <span class="st">"digits"</span><span class="ot">=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 2. Global options</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 3. Import data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/high_popularity_spotify_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 4. Check data</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Are there any missing values in the data set?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Are there any missing values in the data set?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"only 1 missing value. Exclude it"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "only 1 missing value. Exclude it"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>(data)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Is the data in a tibble format?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Is the data in a tibble format?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">is_tibble</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"convert into a tibble format"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#explore the structure</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Step 5. Create an own theme</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>theme_own <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">family =</span> <span class="st">"Barlow"</span>),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">angle=</span><span class="dv">90</span>),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">26</span>, <span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey70"</span>, <span class="at">linewidth =</span>  <span class="fl">0.2</span>),</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.placement =</span> <span class="st">"outside"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.spacing =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">"lines"</span>),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background =</span> <span class="fu">element_blank</span>()) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_col</span>(<span class="fu">viridis_pal</span>(<span class="at">option =</span> <span class="st">"inferno"</span>)(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/palette-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#1 Farbe</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>vi.col_1 <span class="ot">&lt;-</span> <span class="st">"#5D126EFF"</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>vi.col_1<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="st">"#FCA50AFF"</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>vi.col_1<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="st">"#F8850FFF"</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>vi.col_1<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="st">"#DD513AFF"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">#2 Farben </span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>vi.col_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#5D126EFF"</span>, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#FCA50AFF"</span>) </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>vi.col_light <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#FCFFA4FF"</span>,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#FAC62DFF"</span>,</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#FCA50AFF"</span>,</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#F17020FF"</span>, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#DD513AFF"</span>,</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#B1325AFF"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"#932667FF"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="co"># 6 Farben</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>vi.col_6 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#0C0826FF"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#5D126EFF"</span>, </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#932667FF"</span>, </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#DD513AFF"</span>, </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#FCA50AFF"</span>, </span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>              <span class="st">"#FAC62DFF"</span>  </span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>              ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="which-genres-are-dominating-and-when-have-been-the-tracks-released" class="level1">
<h1>Which genres are dominating and when have been the tracks released?</h1>
<p>To get a bigger picture about tracks in the data set, it could be interesting, how many tracks in the data set belongs to a certain genre. Also, it could be a useful background information in which year and which month a song is released.</p>
<p>Firs, let us have closer look to the genres. Genres are assigned by using the Spotify’s categorization of the playlist, where the track in. Overall, the data set contains tracks from 73 playlists. 0 have sung the the tracks, so some artists have sung more than of the songs in the data set or some songs are listed twice, because they are assigned to different genres. All in all 28 are in the data set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a nice table with all the genres in it</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>genres_table <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_genre) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Frequency =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="co">#number per group</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Frequency)) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span> <span class="co">#for nice table</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title=</span><span class="st">"Number of tracks per genre"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(<span class="at">playlist_genre=</span> <span class="st">"Genre"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">column_labels.background.color =</span> vi.col_1)<span class="sc">%&gt;%</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span> <span class="fu">cell_text</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight=</span> <span class="st">'bold'</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">font =</span> <span class="fu">google_font</span>(<span class="st">"Barlow"</span>)),</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_title</span>(<span class="at">groups=</span><span class="st">'title'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_theme_nytimes</span>()</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>genres_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="avmfgttpsw" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#avmfgttpsw table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#avmfgttpsw thead, #avmfgttpsw tbody, #avmfgttpsw tfoot, #avmfgttpsw tr, #avmfgttpsw td, #avmfgttpsw th {
  border-style: none;
}

#avmfgttpsw p {
  margin: 0;
  padding: 0;
}

#avmfgttpsw .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#avmfgttpsw .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#avmfgttpsw .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#avmfgttpsw .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#avmfgttpsw .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avmfgttpsw .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avmfgttpsw .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avmfgttpsw .gt_col_heading {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#avmfgttpsw .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#avmfgttpsw .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#avmfgttpsw .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#avmfgttpsw .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#avmfgttpsw .gt_spanner_row {
  border-bottom-style: hidden;
}

#avmfgttpsw .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#avmfgttpsw .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#avmfgttpsw .gt_from_md > :first-child {
  margin-top: 0;
}

#avmfgttpsw .gt_from_md > :last-child {
  margin-bottom: 0;
}

#avmfgttpsw .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#avmfgttpsw .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#avmfgttpsw .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#avmfgttpsw .gt_row_group_first td {
  border-top-width: 2px;
}

#avmfgttpsw .gt_row_group_first th {
  border-top-width: 2px;
}

#avmfgttpsw .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avmfgttpsw .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#avmfgttpsw .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#avmfgttpsw .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avmfgttpsw .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avmfgttpsw .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#avmfgttpsw .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#avmfgttpsw .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#avmfgttpsw .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#avmfgttpsw .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avmfgttpsw .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avmfgttpsw .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avmfgttpsw .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avmfgttpsw .gt_left {
  text-align: left;
}

#avmfgttpsw .gt_center {
  text-align: center;
}

#avmfgttpsw .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#avmfgttpsw .gt_font_normal {
  font-weight: normal;
}

#avmfgttpsw .gt_font_bold {
  font-weight: bold;
}

#avmfgttpsw .gt_font_italic {
  font-style: italic;
}

#avmfgttpsw .gt_super {
  font-size: 65%;
}

#avmfgttpsw .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#avmfgttpsw .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#avmfgttpsw .gt_indent_1 {
  text-indent: 5px;
}

#avmfgttpsw .gt_indent_2 {
  text-indent: 10px;
}

#avmfgttpsw .gt_indent_3 {
  text-indent: 15px;
}

#avmfgttpsw .gt_indent_4 {
  text-indent: 20px;
}

#avmfgttpsw .gt_indent_5 {
  text-indent: 25px;
}

#avmfgttpsw .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#avmfgttpsw div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: 'Libre Franklin'; font-weight: 800">Number of tracks per genre</th>
</tr>
<tr class="gt_col_headings even">
<th id="playlist_genre" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Genre</th>
<th id="Frequency" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Frequency</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">pop</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">357</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">rock</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">235</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">hip-hop</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">227</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">latin</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">184</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">electronic</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">148</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">gaming</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">100</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">ambient</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">arabic</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">punk</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">50</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">r&amp;b</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">50</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">blues</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">45</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">metal</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">35</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">folk</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">33</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">afrobeats</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">20</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">brazilian</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">14</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">j-pop</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">11</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">classical</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">10</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">k-pop</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">indian</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">korean</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">turkish</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">7</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">reggae</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">indie</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">world</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">country</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">lofi</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">soul</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">2</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="playlist_genre" style="font-family: 'Source Sans Pro'; font-weight: 400">jazz</td>
<td class="gt_row gt_right" headers="Frequency" style="font-family: 'Source Sans Pro'; font-weight: 400">1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>For assessing the genres, I subset the data to avoid bias and get a clearer overview.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(data<span class="sc">$</span>playlist_genre)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>playlist_genre <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>playlist_genre)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>playlist_genre)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#get a subset with genres &gt;=30 to avoid bias</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>genre_levels30 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_genre) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">N=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(N <span class="sc">&gt;=</span><span class="dv">30</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>genre30 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>playlist_genre <span class="sc">%in%</span> genre_levels30<span class="sc">$</span>playlist_genre, <span class="fu">as.character</span>(data<span class="sc">$</span>playlist_genre), <span class="st">"Others"</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>genre30)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#subset to include the big genres &gt;=100 only</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>genre_levels100 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_genre) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">N=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(N <span class="sc">&gt;=</span><span class="dv">100</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>genre100 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>playlist_genre <span class="sc">%in%</span> genre_levels100<span class="sc">$</span>playlist_genre, <span class="fu">as.character</span>(data<span class="sc">$</span>playlist_genre), <span class="st">"Others"</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>genre100)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What genres does the tracks have?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get numbers per subgenre</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>data_genre <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(genre100) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="co">#compute percentages and positions</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(freq <span class="sc">/</span> <span class="fu">sum</span>(freq),<span class="dv">2</span>),<span class="st">"%"</span>), <span class="at">pos=</span> <span class="fu">cumsum</span>(freq) <span class="sc">-</span> freq<span class="dv">-2</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>genre_pie <span class="ot">&lt;-</span><span class="fu">ggplot</span>(data_genre, <span class="fu">aes</span>(<span class="at">x=</span><span class="st">""</span>, <span class="at">y=</span>freq, <span class="at">fill=</span>genre100))<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"stack"</span>,<span class="at">color=</span><span class="st">"white"</span>, <span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>percentage, <span class="at">color=</span>genre100), <span class="at">position=</span> <span class="fu">position_stack</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>,<span class="at">start=</span><span class="dv">0</span>,<span class="at">clip=</span><span class="st">"off"</span>)<span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">family =</span> <span class="st">"Barlow"</span>),</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">fill=</span><span class="st">"Playlist Genre"</span>,<span class="at">title=</span><span class="st">"Tracks by Genre"</span>, <span class="at">subtitle=</span> <span class="st">"Pie Chart"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>genre_pie</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/genre_pie-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Let’s have a look into the subgenres, where categories are under 20 are assigned to the category “Other” for an better overview.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>subgenre_levels50<span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_subgenre) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">N=</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(N <span class="sc">&gt;</span><span class="dv">49</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>subgenre50 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>playlist_subgenre <span class="sc">%in%</span> subgenre_levels50<span class="sc">$</span>playlist_subgenre, <span class="fu">as.character</span>(data<span class="sc">$</span>playlist_subgenre), <span class="st">"Others"</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>subgenre_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># group and summarize the freq</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subgenre50) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">freq=</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get pos and percentages</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(freq <span class="sc">/</span> <span class="fu">sum</span>(freq),<span class="dv">2</span>),<span class="st">"%"</span>), <span class="at">pos=</span> <span class="fu">cumsum</span>(freq) <span class="sc">-</span> freq<span class="dv">-2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get the cumulative percentages for top and bottom of each rectangle</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ymax =</span> <span class="fu">c</span>(<span class="fu">cumsum</span>(freq)),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">ymin =</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">head</span>(ymax, <span class="at">n=</span><span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">pos=</span> ymax <span class="sc">+</span>ymin<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(subgenre50, <span class="st">"</span><span class="sc">\n</span><span class="st">:"</span>, percentage))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>subgenre_donut <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(subgenre_data, <span class="fu">aes</span>(<span class="at">x=</span><span class="fl">3.5</span>, <span class="at">y=</span>freq, <span class="at">fill=</span>subgenre50)) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> percentage, <span class="at">color=</span>subgenre50),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">"white"</span>,<span class="dv">5</span>), <span class="fu">rep</span>(<span class="st">"black"</span>,<span class="dv">4</span>)))<span class="sc">+</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta=</span><span class="st">"y"</span>) <span class="sc">+</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill=</span> <span class="st">"Subgenres"</span>, <span class="at">title=</span><span class="st">"Percentage of Subgenres"</span>, <span class="at">subtitle=</span><span class="st">"Doghnut Plot"</span>)<span class="sc">+</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">3.5</span><span class="sc">+</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>,<span class="at">family =</span> <span class="st">"Barlow"</span>))</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>subgenre_donut</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/subgenre_donut-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>When have been the songs released? What is the time span, we are talking about?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#modify for only getting the years</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>release_year <span class="ot">&lt;-</span> base<span class="sc">::</span><span class="fu">substr</span>(data<span class="sc">$</span>track_album_release_date,<span class="dv">1</span>,<span class="dv">4</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>release_year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(data<span class="sc">$</span>release_year)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#get the months</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">release_month=</span> <span class="fu">month</span>(track_album_release_date))</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"How many values for months are missing?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "How many values for months are missing?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(data<span class="sc">$</span>release_month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE  TRUE 
 1604    81 </code></pre>
</div>
</div>
<p>How old are the songs in the data set?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(data<span class="sc">$</span>release_year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>year_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(release_year))<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"How many of the songs are released in a certain year?"</span>, <span class="at">subtitle=</span> <span class="st">"Histogram"</span>,<span class="at">x=</span><span class="st">"Year"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1950</span>,<span class="dv">2025</span>,<span class="dv">5</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1950</span>,<span class="dv">2025</span>))<span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>year_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/year_hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can see, the most popular songs are not that old! Could we get more information about it?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"What is the average age on an song in the data set?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "What is the average age on an song in the data set?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">track_age =</span> <span class="dv">2024</span> <span class="sc">-</span> release_year)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(data<span class="sc">$</span>track_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"On the average, songs in the data set are around 12 years old/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "On the average, songs in the data set are around 12 years old/"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"And what is the median?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "And what is the median?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(data<span class="sc">$</span>track_age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Interesting! 50 percent of the songs in the data set has been released in the last 6 years!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Interesting! 50 percent of the songs in the data set has been released in the last 6 years!"</code></pre>
</div>
</div>
<p>Is there a favorite month for releasing an album?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>month_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(release_month))<span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span>vi.col_1<span class="fl">.2</span>)<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"How many of the songs are released in a certain year?"</span>, <span class="at">subtitle=</span> <span class="st">"Histogram"</span>,<span class="at">x=</span><span class="st">"Year"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">12</span>,<span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">12</span>))<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>month_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/month_hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Also interesting! Having in mind we have 1604, 81 in the data set, this graph shows none of the tracks have been released in January or December. Most tracks had definitely been reselased October. The begin of autumn gives apparently the spirit for extensive music listening.</p>
</section>
<section id="how-are-the-features-connected-to-each-other" class="level1">
<h1>How are the features connected to each other?</h1>
<p>Twelve audio features are given in this data set, which are used by spotify for data analysis. The following table shows the features:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>feature_tabledata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Features=</span> <span class="fu">c</span>(<span class="st">"Energy"</span>, <span class="st">"Tempo"</span>, <span class="st">"Danceability"</span>, <span class="st">"Loudness"</span>, <span class="st">"liveness"</span>, <span class="st">"Valence"</span>, <span class="st">"Speechiness"</span>, <span class="st">"Instrumentalness"</span>, <span class="st">"Mode"</span>, <span class="st">"Key"</span>,<span class="st">"Duration_ms"</span>, <span class="st">"Acousticness"</span>),</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Description=</span> <span class="fu">c</span>(<span class="st">"A measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy."</span>,<span class="st">"The speed of a track, measured in beats per minute (BPM)."</span>, <span class="st">"A score describing how suitable a track is for dancing based on tempo, rhythm stability, beat strength and overall regularity."</span>, <span class="st">"The overall loudness of a track in decibels (dB). Higher values indicate louder tracks overall."</span>, <span class="st">"The likelihood of a track being performed live. Higher values suggest more audience presence."</span>, <span class="st">"The overall musical positiveness(emotion) of a track. High valence sounds happy; low valence sounds sad or angry."</span>, <span class="st">"Measures the presence of spoken words."</span>, <span class="st">"The likelihood a track contains no vocals. Values closer to 1.0 suggest solely instrumental tracks."</span>, <span class="st">"Indicates the modality of the track."</span>,<span class="st">"The musical key, represented as an integer from 0 to 11, mapping to standard Pitch class notation."</span>,<span class="st">"The length of the track in milliseconds."</span>, <span class="st">"A confidence measure of whether a track is acoustic(1) or not(0)."</span>)) </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>feature_table <span class="ot">&lt;-</span> <span class="fu">gt</span>(feature_tabledata) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title=</span><span class="st">"Features"</span>,<span class="at">subtitle=</span><span class="st">"Spotify's Analysis Features"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">column_labels.background.color =</span> vi.col_1)<span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span> <span class="fu">cell_text</span>(</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight=</span> <span class="st">'bold'</span>,</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">font =</span> <span class="fu">google_font</span>(<span class="st">"Barlow"</span>)),</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_title</span>(<span class="at">groups=</span><span class="st">'title'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color=</span> <span class="st">"thistle"</span>),</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>                <span class="fu">cell_text</span>(<span class="at">weight=</span><span class="st">"bold"</span>)),</span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_body</span>(<span class="at">columns=</span>Features)) <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_theme_nytimes</span>()</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>feature_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fndyofuyme" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#fndyofuyme table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fndyofuyme thead, #fndyofuyme tbody, #fndyofuyme tfoot, #fndyofuyme tr, #fndyofuyme td, #fndyofuyme th {
  border-style: none;
}

#fndyofuyme p {
  margin: 0;
  padding: 0;
}

#fndyofuyme .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fndyofuyme .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fndyofuyme .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fndyofuyme .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fndyofuyme .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fndyofuyme .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fndyofuyme .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fndyofuyme .gt_col_heading {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fndyofuyme .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fndyofuyme .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fndyofuyme .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fndyofuyme .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fndyofuyme .gt_spanner_row {
  border-bottom-style: hidden;
}

#fndyofuyme .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fndyofuyme .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fndyofuyme .gt_from_md > :first-child {
  margin-top: 0;
}

#fndyofuyme .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fndyofuyme .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fndyofuyme .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fndyofuyme .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fndyofuyme .gt_row_group_first td {
  border-top-width: 2px;
}

#fndyofuyme .gt_row_group_first th {
  border-top-width: 2px;
}

#fndyofuyme .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fndyofuyme .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fndyofuyme .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fndyofuyme .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fndyofuyme .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fndyofuyme .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fndyofuyme .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fndyofuyme .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fndyofuyme .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#fndyofuyme .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fndyofuyme .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fndyofuyme .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fndyofuyme .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fndyofuyme .gt_left {
  text-align: left;
}

#fndyofuyme .gt_center {
  text-align: center;
}

#fndyofuyme .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fndyofuyme .gt_font_normal {
  font-weight: normal;
}

#fndyofuyme .gt_font_bold {
  font-weight: bold;
}

#fndyofuyme .gt_font_italic {
  font-style: italic;
}

#fndyofuyme .gt_super {
  font-size: 65%;
}

#fndyofuyme .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fndyofuyme .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fndyofuyme .gt_indent_1 {
  text-indent: 5px;
}

#fndyofuyme .gt_indent_2 {
  text-indent: 10px;
}

#fndyofuyme .gt_indent_3 {
  text-indent: 15px;
}

#fndyofuyme .gt_indent_4 {
  text-indent: 20px;
}

#fndyofuyme .gt_indent_5 {
  text-indent: 25px;
}

#fndyofuyme .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fndyofuyme div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="2" class="gt_heading gt_title gt_font_normal" style="font-family: 'Libre Franklin'; font-weight: 800">Features</th>
</tr>
<tr class="gt_heading even">
<th colspan="2" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Spotify's Analysis Features</th>
</tr>
<tr class="gt_col_headings header">
<th id="Features" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Features</th>
<th id="Description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Description</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Energy</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">A measure of intensity and activity. Typically, energetic tracks feel fast, loud, and noisy.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Tempo</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The speed of a track, measured in beats per minute (BPM).</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Danceability</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">A score describing how suitable a track is for dancing based on tempo, rhythm stability, beat strength and overall regularity.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Loudness</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The overall loudness of a track in decibels (dB). Higher values indicate louder tracks overall.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">liveness</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The likelihood of a track being performed live. Higher values suggest more audience presence.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Valence</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The overall musical positiveness(emotion) of a track. High valence sounds happy; low valence sounds sad or angry.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Speechiness</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">Measures the presence of spoken words.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Instrumentalness</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The likelihood a track contains no vocals. Values closer to 1.0 suggest solely instrumental tracks.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Mode</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">Indicates the modality of the track.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Key</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The musical key, represented as an integer from 0 to 11, mapping to standard Pitch class notation.</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Duration_ms</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">The length of the track in milliseconds.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Features" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">Acousticness</td>
<td class="gt_row gt_left" headers="Description" style="font-family: 'Source Sans Pro'; font-weight: 400">A confidence measure of whether a track is acoustic(1) or not(0).</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s first have a look at two features, that I find particularly interesting, danceability and energy. In my opinion, both features could be very crucial, when it comes to the characterization of music. I would assume, that both features are somehow interwined to each other and also in some way connected to the other factors as well. I would like to explore, if I can see hints for a connection using data visualization. Also, it is likely, that these features are also very different distributed through genres.</p>
<section id="how-are-danceability-and-energy-are-connected" class="level2">
<h2 class="anchored" data-anchor-id="how-are-danceability-and-energy-are-connected">How are danceability and energy are connected?</h2>
<p>Create a density plot to explore, how the distributions overlap. Use all data for it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>energy_dance_dense_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>danceability, <span class="at">y=</span> energy))<span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">colour=</span><span class="st">"#1F988BFF"</span>)<span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d_filled</span>(<span class="at">alpha=</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density_2d</span>(<span class="at">colour=</span><span class="st">"#440154FF"</span>)<span class="sc">+</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Energy and Danceability"</span>, <span class="at">subtilte=</span><span class="st">"Density Plot"</span>)<span class="sc">+</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>(<span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>),<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>energy_dance_dense_plot  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/energy_dance_dense_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Key insights:</p>
<ul>
<li>You can see from this graph, that tracks on spotify are high in energy and danceability (the density under 0.25 in energy and danceability are very low, the highest density is around 0.75 and quite high) → our inituition would say us, that a lot of songs are characterized by high energy and high density. The density plot gives a first hint, that this could actually the case.</li>
</ul>
<p>Let’s create a scatter plot to investigates connections. It gives good insgiths in possible relationsships. Use the data set with only the 6 biggest genres in it, so the plot isn’t to messy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>energy_dance_scat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(danceability, energy))<span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>,<span class="fu">aes</span>(<span class="at">color=</span> genre100))<span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Energy and dancability by genre"</span>, <span class="at">subtitle=</span><span class="st">"Scatter plot"</span>, <span class="at">color=</span> <span class="st">"Playlist genre"</span>)<span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>),<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>energy_dance_scat_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/energy_dance_scat_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Key insights:</p>
<ul>
<li>whereas rock and pop music tracks could also have lower danceability, the most tracks of the other genres are characterized by an higher dancability than 0.4</li>
<li>interesting is, that rock music has higher energy, but if the energy level is lower, they can have also I higher dancability.</li>
<li>most of the electronic tracks are high in energy.</li>
<li>especially for energy you can see that the vast majority is high in energy</li>
</ul>
<p>Let’s plot the density in direct comparison, neglecting the genres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>energy_dance_dense_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data)<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(energy, ..density..), <span class="at">fill=</span>vi.col_1)<span class="sc">+</span> <span class="co">#top</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">0.9</span>, <span class="at">y=</span><span class="fl">0.8</span>,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label=</span><span class="st">"Energy"</span>), <span class="at">color=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(danceability, <span class="sc">-</span>..density..), <span class="at">fill=</span>vi.col_1<span class="fl">.2</span>)<span class="sc">+</span> <span class="co">#bottom</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="fu">aes</span>(<span class="at">x=</span><span class="fl">0.9</span>, <span class="at">y=</span><span class="sc">-</span><span class="fl">0.8</span>,</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">label=</span><span class="st">"Danceability"</span>), <span class="at">color=</span>vi.col_1<span class="fl">.2</span>)<span class="sc">+</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Comparision of Danceability and Energy Distributions"</span>, <span class="at">subtitle=</span> <span class="st">"Kernel Density plots"</span>, <span class="at">xlab=</span><span class="st">"Score of Energy / Danceability"</span>)</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>energy_dance_dense_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: The dot-dot notation (`..density..`) was deprecated in ggplot2 3.4.0.
ℹ Please use `after_stat(density)` instead.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_label(aes(x = 0.9, y = 0.8, label = "Energy"), color = vi.col_1): All aesthetics have length 1, but the data has 1685 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in geom_label(aes(x = 0.9, y = -0.8, label = "Danceability"), color = vi.col_1.2): All aesthetics have length 1, but the data has 1685 rows.
ℹ Please consider using `annotate()` or provide this layer with data containing
  a single row.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>That looks so connected ! Most of the tracks in the data set has a very high danceability and a higher energy!!</p>
<p>Shall we compare the distributions of these items more detailed using kernel densitiy distributions and compare the genres?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>energy_dense_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(energy, ..scaled..))<span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">col=</span> vi.col_1, <span class="at">fill=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Energy score distributions by genres"</span>, <span class="at">subtitle =</span> <span class="st">"Kernel Densitity plot"</span>, <span class="at">x=</span> <span class="st">"Energy"</span>, <span class="at">y=</span> <span class="st">"Density"</span>, )<span class="sc">+</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>genre100)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>energy_dense_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/energy_dense_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dance_dense_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(danceability, ..scaled..))<span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.4</span>, <span class="at">col=</span> vi.col_1<span class="fl">.3</span>, <span class="at">fill=</span>vi.col_1<span class="fl">.3</span>)<span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Danceability score distributions by genres"</span>, <span class="at">subtitle =</span> <span class="st">"Kernel Densitity plot"</span>, <span class="at">x=</span> <span class="st">"Danceability"</span>, <span class="at">y=</span> <span class="st">"Density"</span>, )<span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>genre100)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>dance_dense_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/dance_dense_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Key insights:</p>
<ul>
<li>While electronic, pop, and rock are very high in energy, especially latin and hip hop music has a very high danceability</li>
<li>it seems like that songs, that have a middle to high danceability has a middle to high energy.</li>
</ul>
<p>It seems like danceability and energy are somehow connected. Are there songs, that have a higher danceability and are lower in energy or vice versa? Let’s find out using the whole data set this time!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>highenergy_lowdance <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(energy<span class="sc">&gt;</span> <span class="fl">0.25</span> <span class="sc">&amp;</span> danceability<span class="sc">&lt;</span> <span class="fl">0.25</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(track_artist, track_name, playlist_genre, track_popularity, energy, tempo, danceability, loudness, liveness, valence, speechiness,instrumentalness,acousticness,playlist_subgenre)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>highenergy_lowdance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         track_artist                           track_name playlist_genre
1 Stone Temple Pilots Interstate Love Song - 2019 Remaster           rock
2            Coldplay                              Fix You            pop
3 My Chemical Romance             I'm Not Okay (I Promise)           punk
4 My Chemical Romance                     The Ghost of You           punk
5      Lynyrd Skynyrd                            Free Bird           rock
  track_popularity energy tempo danceability loudness liveness valence
1               72  0.927   171        0.215    -7.33   0.1260   0.490
2               82  0.417   138        0.209    -8.74   0.1130   0.124
3               74  0.940   180        0.210    -3.43   0.2690   0.255
4               70  0.886   146        0.202    -3.81   0.6430   0.192
5               75  0.834   118        0.249    -8.21   0.0924   0.337
  speechiness instrumentalness acousticness playlist_subgenre
1      0.0452        0.0066100     0.000273           classic
2      0.0338        0.0019600     0.164000              soft
3      0.1230        0.0000000     0.006020          pop punk
4      0.0816        0.0000000     0.028600          pop punk
5      0.0574        0.0000969     0.074200          southern</code></pre>
</div>
</div>
<p>Looks like tracks with high energy and low danceability are kind of outliers and deviates from the patterns. If you inspect the table you can see, that all the five songs have low speechiness, low instrumentalness and low acoustics in common. Though, they don’t belong to the same genre.</p>
<p>Having a look on the next table, where tracks have a high danceability and low energy, you can see this is a much more common combination. Especially ambient tracks have these characteristics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>lowenergy_highdance <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(energy<span class="sc">&lt;</span> <span class="fl">0.25</span> <span class="sc">&amp;</span> danceability<span class="sc">&gt;</span> <span class="fl">0.25</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(track_artist, track_name, playlist_genre, track_popularity, energy, tempo, danceability, loudness, liveness, valence, speechiness,instrumentalness,acousticness,playlist_subgenre) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(danceability)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"This are the top ten at the list, ordered by danceability"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "This are the top ten at the list, ordered by danceability"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lowenergy_highdance,<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              track_artist                 track_name
1                                 leadwave                   memories
2  The Cinematic Orchestra, Patrick Watson            To Build A Home
3                           Gibran Alcocer                     Idea 1
4                       Fabrizio Paterlini                      Waltz
5                              Hans Zimmer                       Time
6                           Patrick Watson   Je te laisserai des mots
7                            Billie Eilish         listen before i go
8                          Whitney Houston     I Will Always Love You
9                  Lana Del Rey, Bleachers Margaret (feat. Bleachers)
10                          Gibran Alcocer                     Idea 9
   playlist_genre track_popularity energy tempo danceability loudness liveness
1      electronic               70 0.0823  67.2        0.252    -27.3   0.0857
2            folk               72 0.1220 148.7        0.264    -15.4   0.0940
3       classical               71 0.1460 172.1        0.265    -21.1   0.1040
4       classical               71 0.0516  87.6        0.270    -33.8   0.1120
5       classical               71 0.0968  62.9        0.286    -16.8   0.0861
6            folk               83 0.1870 132.7        0.303    -16.8   0.1020
7         ambient               74 0.0561  79.8        0.319    -23.0   0.3880
8           blues               75 0.2140  67.5        0.332    -12.5   0.0839
9         ambient               78 0.2450 103.8        0.340    -13.4   0.0633
10      classical               72 0.1380 128.6        0.340    -24.9   0.1120
   valence speechiness instrumentalness acousticness playlist_subgenre
1   0.0381      0.0344       0.92800000        0.951         vaporwave
2   0.0735      0.0349       0.34900000        0.885             indie
3   0.4160      0.0323       0.89300000        0.985     neo-classical
4   0.1990      0.0442       0.95300000        0.986     neo-classical
5   0.0395      0.0323       0.69600000        0.178     neo-classical
6   0.2120      0.0356       0.49900000        0.989             indie
7   0.0820      0.0450       0.00384000        0.935          academic
8   0.1100      0.0349       0.00000562        0.845           classic
9   0.1920      0.0319       0.09920000        0.969          academic
10  0.3250      0.0357       0.84600000        0.984     neo-classical</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"How many tracks meet this characteristics?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "How many tracks meet this characteristics?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(lowenergy_highdance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 41</code></pre>
</div>
</div>
</section>
<section id="which-role-plays-the-tempo-for-danceability-and-energy" class="level2">
<h2 class="anchored" data-anchor-id="which-role-plays-the-tempo-for-danceability-and-energy">Which role plays the tempo for danceability and energy?</h2>
<p>First of all, tempo is often seen as a good indicator for genres. Let’s explore if this is true for this data with a dot plot!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the data and get the mean and standard deviation</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>tempo_dot_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_genre) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Mean=</span> <span class="fu">mean</span>(tempo), <span class="at">SD=</span> <span class="fu">sd</span>(tempo))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot a cleaveland dot plot</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>tempo_genre_dot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(tempo_dot_data, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(playlist_genre, Mean), <span class="at">y=</span>Mean))<span class="sc">+</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean <span class="sc">-</span> SD, <span class="at">ymax =</span> Mean <span class="sc">+</span> SD ), <span class="at">size=</span><span class="dv">1</span>, <span class="at">col=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"The average tempo and the standard deviation per genre"</span>, <span class="at">subtitle=</span><span class="st">"Cleaveland Dotplot"</span>, <span class="at">x=</span> <span class="st">"Genre"</span>, <span class="at">y=</span><span class="st">"Tempo in BPM"</span>)<span class="sc">+</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">coord_flip</span>()</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>tempo_genre_dot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_segment()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/tempo_dot_data-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Overall, the average BPM in each genre is quite high! That is a bit surprising, because music experts detected lower BPM are common for certain music types. For instance, Hip Hop is normally characterized by 85 to 95 BPM. Could be a hint, that popular tracks are a bit faster, than usual for their genre.</p>
<p>Let’s create a categorial variable for tempo to explore, how tempo is connected to danceability and energy.</p>
<p>First, plot a density plot to see the distribution for useful categorization. Use the full data set this time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>tempo_dense_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(tempo))<span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>,<span class="at">color=</span>vi.col_1, <span class="at">fill=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">colour=</span>vi.col_1,<span class="at">fill=</span> vi.col_1, <span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">250</span>,<span class="dv">50</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">250</span>))<span class="sc">+</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Tempo distribution of tracks"</span>, <span class="at">subtitle =</span> <span class="st">"Densitity plot"</span>, <span class="at">x=</span> <span class="st">"Density"</span>, <span class="at">y=</span> <span class="st">"Tempo in BPM"</span>)<span class="sc">+</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>tempo_dense_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 2 rows containing missing values or values outside the scale range
(`geom_bar()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/tempo_dense_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>You can see, there is a wide range of tempo! Let’s build categories out of it!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">tempo_cat =</span> <span class="fu">case_when</span>(tempo <span class="sc">&lt;</span> <span class="dv">90</span> <span class="sc">~</span> <span class="st">"less than 90"</span>,</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>                                                    tempo <span class="sc">&lt;=</span> <span class="dv">120</span> <span class="sc">~</span> <span class="st">"up to 120"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>                                                    tempo <span class="sc">&lt;=</span> <span class="dv">150</span> <span class="sc">~</span> <span class="st">"up to 150"</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>                                                  tempo <span class="sc">&lt;=</span>  <span class="dv">180</span> <span class="sc">~</span> <span class="st">"up to 180"</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>                                                  tempo <span class="sc">&gt;</span>  <span class="dv">180</span> <span class="sc">~</span> <span class="st">"more than 180"</span>))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co">#relevel</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>tempo_cat <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>tempo_cat, <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"less than 90"</span>,<span class="st">"up to 120"</span>,<span class="st">"up to 150"</span>,<span class="st">"up to 180"</span>, <span class="st">"more than 180"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>energy_dance_tempo_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(danceability, energy))<span class="sc">+</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>, <span class="at">col=</span>vi.col_1<span class="fl">.3</span>)<span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Energy and dancability by genre"</span>, <span class="at">subtitle=</span><span class="st">"Scatter plot"</span>, <span class="at">color=</span> <span class="st">"Playlist genre"</span>)<span class="sc">+</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>),<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>tempo_cat)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>energy_dance_tempo_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/energy_dance_tempo_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Looks like over 180 BPM is a bit hard to dance to. Though the energy is very high!<br>
Overall, the established range of songs between 90 and 120 BPM has in general the best scores for danceability and energy. Not that much of surprise, isn’t it?</p>
<p>So far, we investigated how three of the features are related to each other using data visualization. Following the former steps of data visualitzation we are only able to plot three variables at once. Of course, we could add a forth variable to it, using another group variable in the “Energy and dance by genre” graph. But in doing this, the graph isn’t very concise anymore and the recipient will need a lot of time to find out what is exactly going on. So, let’s move to the next step for plotting multiple relationships of the features at once.</p>
</section>
<section id="how-do-each-of-the-features-correlate-with-each-other" class="level2">
<h2 class="anchored" data-anchor-id="how-do-each-of-the-features-correlate-with-each-other">How do each of the features correlate with each other?</h2>
<p>With a correlation plot, we can visualize the relationships of all features at once.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># subset the data set to extract only features out of it</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>features_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(energy, tempo, danceability, loudness, liveness, valence, speechiness,  instrumentalness,acousticness,duration_ms, key, mode)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># create a correlation matrix</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>features_cor <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cor</span>(features_data),<span class="dv">1</span>)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># create a corrplot</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>features_corrplot <span class="ot">&lt;-</span> <span class="fu">ggcorrplot</span>(features_cor, </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>                                <span class="at">hc.order=</span><span class="cn">TRUE</span>, <span class="co">#use hierarchical clustering for better overview</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>                                <span class="at">type=</span> <span class="st">"upper"</span>, <span class="co">#only the upper part for better overview, cause two sided correlation</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">outline.col =</span> <span class="st">"white"</span>,</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">lab=</span><span class="cn">TRUE</span>) <span class="sc">+</span> <span class="co">#get labels</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> vi.col_light)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for fill is already present.
Adding another scale for fill, which will replace the existing scale.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>features_corrplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/features_corrplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>What we can see from the plot is that only vert few features are connected to each other, interesting!<br>
Not connected with any feature in a remarkable way:<br>
- key, speechiness, liveness, mode, tempo, duration and instrumentalness have no or only a minimum (&gt;=0.2) correlation to the other features - valence and danceability and valence and energy has a small correlation of 0.3 -&gt; there is a small correlation in the positiveness of a track and their danceability and energy, what seems to make sense, don’t you think? - energy and loudness (0.6) have a positive, moderate correlation -&gt; the more loud the music is, the more energy is in the music and vice versa - also, the energetic the music is, the less acoustic a track is (-0.7) (and vice versa) - the more acoustic (-.05) or instrumental (-0.4) a track is, the less loud is song. - was is especially interesting is, that the correlation of energy and danceability is zero, which means, no linear connection can’t be found. This is very contradictory what can be assessed from the data visualisation before. That does not necessarily mean that there isn’t any realtionship at all, it is more an indicator, that no linear relationship can’t be found in the data.</p>
</section>
</section>
<section id="is-there-a-secret-receipt-for-a-tracks-popularity" class="level1">
<h1>Is there a secret receipt for a tracks’ popularity?</h1>
<p>Of course, we could further investigate, how the features are connected to each other and how the relationship of the certain categories looks like. However, these features are created by spotify to deconstruct a track into certain components for the purpose of analysis. So, it would be more suitable to use them in that way. One option is, to use the features and create models to predict certain genres. Sadly, the dataset is a bit small for that and underrepresented genres fall short. A better option is to use the characterists and analyze, if we can build a convincing model to predict the popularity in tracks. Can we find a secret receipt for a track’s popularity?</p>
<section id="the-distribution-of-popularity" class="level2">
<h2 class="anchored" data-anchor-id="the-distribution-of-popularity">The distribution of popularity</h2>
<p>Before we start, let’s explore the distribution of popularity in this track.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"What are the top ten tracks?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "What are the top ten tracks?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(track_artist, track_name, playlist_genre, track_popularity) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(track_popularity))  <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            track_artist         track_name playlist_genre track_popularity
1  Lady Gaga, Bruno Mars   Die With A Smile            pop              100
2  Lady Gaga, Bruno Mars   Die With A Smile         gaming              100
3  Lady Gaga, Bruno Mars   Die With A Smile            pop              100
4       ROSÉ, Bruno Mars               APT.            pop               98
5       ROSÉ, Bruno Mars               APT.            pop               98
6          Billie Eilish BIRDS OF A FEATHER            pop               97
7          Billie Eilish BIRDS OF A FEATHER         gaming               97
8          Billie Eilish BIRDS OF A FEATHER            pop               97
9          Chappell Roan   Good Luck, Babe!            pop               94
10         Chappell Roan   Good Luck, Babe!         gaming               94</code></pre>
</div>
</div>
<p>Okay, interesting! All of the tracks belongs to the genre pop or genre and some of the songs are listed twice, because their genre assignment to pop and gaming. What are the most unpopular songs?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"What are the ten most unpopular songs?"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "What are the ten most unpopular songs?"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(track_artist, track_name, playlist_genre, track_popularity) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(track_popularity)  <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                        track_artist
1                                                          Van Halen
2                                                             Eagles
3  Pyotr Ilyich Tchaikovsky, André Previn, London Symphony Orchestra
4                                   Ludwig van Beethoven, Paul Lewis
5                                                      BabyChiefDoit
6                                                        BigXthaPlug
7                                  41, Kyle Richh, Jenn Carter, TaTa
8                                    Pop Smoke, 50 Cent, Roddy Ricch
9                                                             Polo G
10                                        Lil Durk, Lil Baby, Polo G
                                                                       track_name
1                                               You Really Got Me - 2015 Remaster
2                                           Life in the Fast Lane - 2013 Remaster
3                  Tchaikovsky: Swan Lake, Op. 20, Act 2: No. 10, Scene. Moderato
4  Sonata No. 14 "Moonlight" in C-Sharp Minor", Op. 27 No. 2: I. Adagio sostenuto
5                                                                       The Viper
6                                                                     The Largest
7                                      Bent (with Kyle Richh, Jenn Carter &amp; TaTa)
8                                           The Woo (feat. 50 Cent &amp; Roddy Ricch)
9                                                                      Neva Cared
10                                        3 Headed Goat (feat. Lil Baby &amp; Polo G)
   playlist_genre track_popularity
1            rock               68
2            rock               68
3       classical               68
4       classical               68
5         hip-hop               68
6         hip-hop               68
7         hip-hop               68
8         hip-hop               68
9         hip-hop               68
10        hip-hop               68</code></pre>
</div>
</div>
<p>We can see, the ten least popular tracks sharing the same popularity value of 68.</p>
<p>And what is the overall distribution?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>pop_hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>track_popularity))<span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">binwidth=</span><span class="dv">1</span>, <span class="at">color=</span>vi.col_1, <span class="at">fill=</span>vi.col_1, <span class="at">alpha=</span><span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">color=</span>vi.col_1, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">alpha=</span>.<span class="dv">5</span>, <span class="at">fill=</span>vi.col_1, <span class="at">bw=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Distribution of popularity"</span>,<span class="at">subtitle=</span><span class="st">"Histogram"</span>, <span class="at">x=</span><span class="st">"Popularity"</span>, <span class="at">y=</span><span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">65</span>,<span class="dv">100</span>,<span class="dv">5</span>), <span class="at">limits=</span><span class="fu">c</span>(<span class="dv">65</span>,<span class="dv">100</span>))</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>pop_hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/pop_hist-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>only a few tracks reach a very high popularity score. Most of the tracks have a score from 68 to 78.</li>
</ul>
<p>Now, let’s explore the popularity by genre.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>pop_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(playlist_genre) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">Mean=</span><span class="fu">mean</span>(track_popularity), <span class="at">SD=</span><span class="fu">sd</span>(track_popularity))</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>pop_dot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pop_data, <span class="fu">aes</span>(<span class="at">y=</span> Mean, <span class="at">x=</span><span class="fu">reorder</span>(playlist_genre, Mean)), <span class="at">color=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Mean <span class="sc">-</span> SD, <span class="at">ymax =</span> Mean <span class="sc">+</span> SD ), <span class="at">color=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Popularity by Genre"</span>, <span class="at">subtitle=</span><span class="st">"Cleaveland Dotplot"</span>)<span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">90</span>))<span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()<span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="st">"Genre"</span>, <span class="at">x=</span><span class="st">"Popularity"</span>)<span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>pop_dot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_segment()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/pop_dot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Gaming and pop are by far the most genres with the most popular songs on overage, while jazz, korean, indian, classical and reggae genres contains the least popular tracks.</li>
</ul>
</section>
<section id="is-very-happy-sad-or-angry-music-more-popular-visualizing-the-influence-of-valence-on-popularity" class="level2">
<h2 class="anchored" data-anchor-id="is-very-happy-sad-or-angry-music-more-popular-visualizing-the-influence-of-valence-on-popularity">Is very happy, sad or angry music more popular? Visualizing the influence of valence on popularity</h2>
<p>The valence indicates the overall musical positiveness(emotion) of a track. High valence sounds happy; low valence sounds sad or angry. How are the valence and the track’s popularity connected? Is very sad, angry or happt music more popular than emotional neutral music?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>val_pop_scat_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(valence, track_popularity))<span class="sc">+</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.7</span>,<span class="at">col=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>loess, <span class="at">se=</span><span class="cn">TRUE</span>, <span class="at">color=</span>vi.col_1<span class="fl">.3</span>)<span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Musical positiveness and popularity by genre"</span>, <span class="at">subtitle=</span><span class="st">"Scatter plot with linear polynomial regression"</span>, <span class="at">color=</span> <span class="st">"Playlist genre"</span>, <span class="at">x=</span><span class="st">"Musical positiveness"</span>, <span class="at">y=</span><span class="st">"Popularity"</span>)<span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">discrete=</span><span class="cn">TRUE</span>, <span class="at">option=</span><span class="st">"inferno"</span>)<span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.25</span>),<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>val_pop_scat_plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/val_pop_scat_plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No relation visible.</p>
<p>We could now move on to the other futures and visualize the relationships. A better method is, to find a suitable model, where all impactful features are included and weighted according their relevance for the tracks popularity. For this, let’s create a training set and a test and validation set. Precondition is, that we have each track only once in the data set, so we must remove duplicates from the set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">#get songs in minutes instead of miliseconds, because could construct some bias</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>features_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">duration_min =</span> duration_ms<span class="sc">/</span><span class="dv">60000</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remove the duplicates </span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>features_data <span class="ot">&lt;-</span> features_data <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(track_name, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="co"># only features and predictor</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>features_data <span class="ot">&lt;-</span> features_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(track_popularity,  energy,tempo, danceability,liveness, loudness,valence, speechiness, instrumentalness, mode, key, acousticness, duration_min)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">#create partition</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(features_data<span class="sc">$</span>track_popularity, <span class="at">p =</span> .<span class="dv">7</span>, </span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">list =</span> <span class="cn">FALSE</span>, </span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">times =</span> <span class="dv">1</span>)</span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">#create training data</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> features_data[train_index,]</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="co">#create val and test set</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>val_test_data <span class="ot">&lt;-</span> features_data[<span class="sc">-</span>train_index,]</span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co"># remaining 30% into validation and test set</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>val_index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(val_test_data<span class="sc">$</span>track_popularity, <span class="at">p =</span> .<span class="dv">6</span>, </span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">list =</span> <span class="cn">FALSE</span>, </span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">times =</span> <span class="dv">1</span>)</span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>val_data <span class="ot">&lt;-</span> val_test_data[val_index,]</span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> val_test_data[<span class="sc">-</span>val_index,]</span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Outcome of this section is that the data (100%) is split into:</span></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="co"># training (~70%)</span></span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="co"># validation (~20%)</span></span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="co"># test (~10%)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Are the popularity equally distributed in the training, validation and test set?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data=</span> train_data, <span class="fu">aes</span>(<span class="at">x=</span>track_popularity, <span class="at">color=</span> <span class="st">"t"</span>), <span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.2</span>)<span class="sc">+</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data=</span> val_data, <span class="fu">aes</span>(<span class="at">x=</span>track_popularity, <span class="at">color=</span><span class="st">"v"</span>), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">data=</span> test_data, <span class="fu">aes</span>(<span class="at">x=</span>track_popularity, <span class="at">color=</span><span class="st">"te"</span>), <span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name=</span> <span class="st">"color"</span>, <span class="at">values=</span><span class="fu">c</span>(<span class="st">"t"</span><span class="ot">=</span>vi.col_1, <span class="st">"v"</span><span class="ot">=</span>vi.col_1<span class="fl">.2</span>,<span class="st">"te"</span><span class="ot">=</span>vi.col_1<span class="fl">.4</span>), <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"test"</span>, <span class="st">"valid"</span>, <span class="st">"train"</span>))<span class="sc">+</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>hist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>While the test and train set looks very similar, the validation set is a bit volatil and has less unpopular tracks.</p>
</section>
<section id="what-features-are-important-for-the-popularity" class="level2">
<h2 class="anchored" data-anchor-id="what-features-are-important-for-the-popularity">What features are important for the popularity?</h2>
<p>All in all, we have 12 features, with which the tracks can be characterized. What features matters for popularity and how is the relationship between a feature and the popularity of a track? For instance, is the energy of track a meaningful feature and if so, does the increase of energy always comes along with an increase inpopularity or could be, that too much energy is detrimental to the popularity as well?</p>
<section id="linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression">Linear regression</h3>
<p>We start with a simple linear regression. If we compute a linear regression model, we can determine the average effect of a feature, if the feature increases by 1, holding the other predictors fixed. Thus, it is necessary for the interpretation to keep the feature’s bandwith in mind. Let’s create some descriptives of the features and the outcome.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">#do we have missing values in here?</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">is.na</span>(features_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
FALSE 
18291 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's get the summaries</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>features_descr<span class="ot">&lt;-</span> features_data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">summarise_all</span>(<span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max, <span class="at">avg=</span>mean, <span class="at">SD=</span>sd)) </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#get a nicer data frame</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>features_descr <span class="ot">&lt;-</span> features_descr <span class="sc">%&gt;%</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">everything</span>(), <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"item"</span>, <span class="st">".value"</span>), <span class="at">names_pattern=</span><span class="st">"(.*)_(.*)"</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>() </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>features_descr <span class="ot">&lt;-</span> features_descr <span class="sc">%&gt;%</span><span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), round,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `across(where(is.numeric), round, 2)`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get a nice table</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>features_data_table <span class="ot">&lt;-</span> features_descr <span class="sc">%&gt;%</span> <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(<span class="at">title=</span><span class="st">"Descriptives of features"</span>,<span class="at">subtitle=</span><span class="st">"Minimum, Maximum, Average and SD of the features"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cols_label</span>(</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">item=</span> <span class="st">"Feature"</span>,</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">min =</span> <span class="st">"Minimum"</span>,</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">max =</span> <span class="st">"Maximum"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fmt_number</span>(<span class="at">rows=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">decimals =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(<span class="at">column_labels.background.color =</span> vi.col_1)<span class="sc">%&gt;%</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_style</span>(</span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span> <span class="fu">cell_text</span>(</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">weight=</span> <span class="st">'bold'</span>,</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">font =</span> <span class="fu">google_font</span>(<span class="st">"Barlow"</span>)),</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_title</span>(<span class="at">groups=</span><span class="st">'title'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tab_style</span>(</span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">style=</span> <span class="fu">list</span>(<span class="fu">cell_fill</span>(<span class="at">color=</span> <span class="st">"thistle"</span>),</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>                <span class="fu">cell_text</span>(<span class="at">weight=</span><span class="st">"bold"</span>)),</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations=</span><span class="fu">cells_body</span>(<span class="at">columns=</span>item)) <span class="sc">%&gt;%</span></span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt_theme_nytimes</span>()</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>features_data_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="daburuffqr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Libre+Franklin:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Source+Sans+Pro:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#daburuffqr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#daburuffqr thead, #daburuffqr tbody, #daburuffqr tfoot, #daburuffqr tr, #daburuffqr td, #daburuffqr th {
  border-style: none;
}

#daburuffqr p {
  margin: 0;
  padding: 0;
}

#daburuffqr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#daburuffqr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#daburuffqr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#daburuffqr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#daburuffqr .gt_heading {
  background-color: #FFFFFF;
  text-align: left;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#daburuffqr .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#daburuffqr .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#daburuffqr .gt_col_heading {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#daburuffqr .gt_column_spanner_outer {
  color: #FFFFFF;
  background-color: #5D126E;
  font-size: 12px;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#daburuffqr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#daburuffqr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#daburuffqr .gt_column_spanner {
  border-bottom-style: none;
  border-bottom-width: 1px;
  border-bottom-color: #334422;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#daburuffqr .gt_spanner_row {
  border-bottom-style: hidden;
}

#daburuffqr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#daburuffqr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#daburuffqr .gt_from_md > :first-child {
  margin-top: 0;
}

#daburuffqr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#daburuffqr .gt_row {
  padding-top: 7px;
  padding-bottom: 7px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#daburuffqr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#daburuffqr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#daburuffqr .gt_row_group_first td {
  border-top-width: 2px;
}

#daburuffqr .gt_row_group_first th {
  border-top-width: 2px;
}

#daburuffqr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#daburuffqr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#daburuffqr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#daburuffqr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#daburuffqr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#daburuffqr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#daburuffqr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#daburuffqr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#daburuffqr .gt_table_body {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #FFFFFF;
}

#daburuffqr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#daburuffqr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#daburuffqr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#daburuffqr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#daburuffqr .gt_left {
  text-align: left;
}

#daburuffqr .gt_center {
  text-align: center;
}

#daburuffqr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#daburuffqr .gt_font_normal {
  font-weight: normal;
}

#daburuffqr .gt_font_bold {
  font-weight: bold;
}

#daburuffqr .gt_font_italic {
  font-style: italic;
}

#daburuffqr .gt_super {
  font-size: 65%;
}

#daburuffqr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#daburuffqr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#daburuffqr .gt_indent_1 {
  text-indent: 5px;
}

#daburuffqr .gt_indent_2 {
  text-indent: 10px;
}

#daburuffqr .gt_indent_3 {
  text-indent: 15px;
}

#daburuffqr .gt_indent_4 {
  text-indent: 20px;
}

#daburuffqr .gt_indent_5 {
  text-indent: 25px;
}

#daburuffqr .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#daburuffqr div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="5" class="gt_heading gt_title gt_font_normal" style="font-family: 'Libre Franklin'; font-weight: 800">Descriptives of features</th>
</tr>
<tr class="gt_heading even">
<th colspan="5" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border">Minimum, Maximum, Average and SD of the features</th>
</tr>
<tr class="gt_col_headings header">
<th id="item" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Feature</th>
<th id="min" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Minimum</th>
<th id="max" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">Maximum</th>
<th id="avg" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">avg</th>
<th id="SD" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="color: #A9A9A9; font-family: 'Source Sans Pro'; text-transform: uppercase" scope="col">SD</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">track_popularity</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">68</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">100</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">75</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">energy</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">1</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">1</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">tempo</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">49.30</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">209.69</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">121.27</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">27.33</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">danceability</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.14</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">0.98</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.65</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.16</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">liveness</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.02</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">0.95</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.17</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.13</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">loudness</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">-43.64</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">1.29</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">-6.83</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">3.55</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">valence</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.03</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">0.98</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.53</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.24</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">speechiness</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.02</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">0.85</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.10</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.10</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">instrumentalness</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.00</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">0.97</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.04</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.16</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">mode</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.00</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">1.00</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.58</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.49</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">key</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.00</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">11.00</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">5.33</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">3.61</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">acousticness</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">0.00</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">1.00</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">0.23</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.26</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="item" style="background-color: #D8BFD8; font-weight: 400; font-family: 'Source Sans Pro'">duration_min</td>
<td class="gt_row gt_right" headers="min" style="font-family: 'Source Sans Pro'; font-weight: 400">1.03</td>
<td class="gt_row gt_right" headers="max" style="font-family: 'Source Sans Pro'; font-weight: 400">9.12</td>
<td class="gt_row gt_right" headers="avg" style="font-family: 'Source Sans Pro'; font-weight: 400">3.57</td>
<td class="gt_row gt_right" headers="SD" style="font-family: 'Source Sans Pro'; font-weight: 400">0.98</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>We can clearly see, that the scores have very different ranges. One option is, to normalize the scores, so each score has an average of zero, while the highest possible score is 1 and the lowest possible score is 1. This has the big disadvantage, that it is not that straighforward to interprete the results with such scores. With normalized scores, one unit increase in the tempo means, that if you compare tracks with the lowest tempo to tracks with the average tempo the popularity of a track will increase by XX. You can see, this is a bit complicated description. Concluding, we don’t normalize !</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>model_lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(track_popularity <span class="sc">~</span>energy <span class="sc">+</span> tempo<span class="sc">+</span>danceability<span class="sc">+</span>loudness<span class="sc">+</span>liveness<span class="sc">+</span>valence<span class="sc">+</span>speechiness<span class="sc">+</span>instrumentalness<span class="sc">+</span>mode<span class="sc">+</span>key<span class="sc">+</span>acousticness<span class="sc">+</span>duration_min, <span class="at">data=</span>features_data)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = track_popularity ~ energy + tempo + danceability + 
    loudness + liveness + valence + speechiness + instrumentalness + 
    mode + key + acousticness + duration_min, data = features_data)

Residuals:
   Min     1Q Median     3Q    Max 
-9.186 -4.097 -0.869  3.295 24.188 

Coefficients:
                 Estimate Std. Error t value             Pr(&gt;|t|)    
(Intercept)      83.66444    1.88708   44.34 &lt; 0.0000000000000002 ***
energy           -3.92141    1.33573   -2.94              0.00338 ** 
tempo             0.00161    0.00540    0.30              0.76581    
danceability     -1.47713    1.12573   -1.31              0.18968    
loudness          0.25623    0.06574    3.90              0.00010 ***
liveness          1.25557    1.16093    1.08              0.27966    
valence          -0.26439    0.71574   -0.37              0.71189    
speechiness      -9.03458    1.50650   -6.00         0.0000000026 ***
instrumentalness -1.01855    1.01300   -1.01              0.31484    
mode             -0.27865    0.29903   -0.93              0.35158    
key              -0.04467    0.04033   -1.11              0.26814    
acousticness     -0.84766    0.74340   -1.14              0.25438    
duration_min     -0.53182    0.15313   -3.47              0.00053 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.39 on 1394 degrees of freedom
Multiple R-squared:  0.0485,    Adjusted R-squared:  0.0403 
F-statistic: 5.93 on 12 and 1394 DF,  p-value: 0.000000000381</code></pre>
</div>
</div>
<ul>
<li>seems only that the energy, the loudness, the speechiness and the duration in minutes have significant and substantial effects.</li>
<li>according to this linear regression, if the energy of a track is very slow, quiet and calm, a tracks popularity is reduced by 4 points, holding the other factors constant. Consistent to this, if a song is louder by ten decibels, the tracks popularity increases bt 2.5.</li>
<li>What seems also very important is the speechiness of songs. Songs with a high number of spoken words have on average 10 points lower popularity as songs with only a few spoken words.</li>
<li>the longest track in the data set is over 9 minutes. If a track is one minute shorter than that, popularity will increase by 0.5 units. However, it would be a bit counterintuitive to assume a linear relationsship here.</li>
</ul>
<p>So far, so good. In this model a linear relationsship is assumed for each feature. It is highly possible, that we are extremely underfitting the data and the model is not flexible enough for the patterns in reality.</p>
<p>Let’s plot the predicted and the actual values of the data set against each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pop_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model_lm1, <span class="at">newdata=</span>features_data)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>pop_pred_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actual_pop =</span>features_data<span class="sc">$</span>track_popularity,</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">pop_pred =</span> pop_pred)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>pred_scatter <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(pop_pred_data, <span class="fu">aes</span>(<span class="at">x=</span>pop_pred, <span class="at">y=</span>actual_pop))<span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.5</span>, <span class="at">col=</span>vi.col_1)<span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span> <span class="st">"Prediction of the tracks popularity"</span>, <span class="at">x=</span> <span class="st">"Predicition"</span>, <span class="at">y=</span><span class="st">"Given Popularity values"</span>)<span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_own</span>()</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>pred_scatter</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/pred_scatter-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We are far away seeing a linear line here. If model_lm1 would be the perfect model, we could see a linear regression line, because each point on the y axis would be the same as the predicted one.</p>
</section>
</section>
<section id="tuning-linear-regressions-and-model-fit" class="level2">
<h2 class="anchored" data-anchor-id="tuning-linear-regressions-and-model-fit">Tuning Linear Regressions and Model Fit</h2>
<p>We can assess the model fit using the mse. It gives us insights, how much our model predicitions differ from the observed values.</p>
<p><span class="math display">\[
MSE = \frac{1}{n} \sum_{i=1}^{n} (y - \hat{y})^2
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="cf">function</span>(y_true, y_pred) {</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>((y_true <span class="sc">-</span> y_pred)<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">#What is the mean squared error for the training set?</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mse</span>(train_data<span class="sc">$</span>track_popularity, <span class="fu">predict</span>(model_lm1, train_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28</code></pre>
</div>
</div>
<p>The average deviation from our prediction is 28.8, what is quite high against the background that the minimum popularity ios 68 and the highest 100.</p>
<p>In the next step, we compute the mse for the validation set. The MSE of our validation set helps us to finde the model, that fits not the data it is generated from, but the another subset of the same the same data to avoid overfitting.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mse</span>(val_data<span class="sc">$</span>track_popularity, <span class="fu">predict</span>(model_lm1, val_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.3</code></pre>
</div>
</div>
<p>We can see, the MSE gets slightly worse, if we predict our model on the validation set.</p>
<p>Using all the features, not all of them seems to be substantial and significant. Sorting all the insignificant factors out, could be problmatic, because for example the effect of energy is computed, holding the other features constant. A better option is, to identify the best subset of the factors.</p>
<p>Therefore, we generate formulas for each possible combination of the features, restricting the number of parameters to 6.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>generate_formulas <span class="ot">&lt;-</span> <span class="cf">function</span>(p, x_vars, y_var) {</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Input checking</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">%%</span> <span class="dv">1</span> <span class="sc">!=</span> <span class="dv">0</span>)           <span class="fu">stop</span>(<span class="st">"Input an integer n"</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (p <span class="sc">&gt;</span> <span class="fu">length</span>(x_vars))    <span class="fu">stop</span>(<span class="st">"p should be smaller than number of vars"</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.character</span>(x_vars)) <span class="fu">stop</span>(<span class="st">"x_vars should be a character vector"</span>)</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.character</span>(y_var))  <span class="fu">stop</span>(<span class="st">"y_vars should be character type"</span>)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combn generates all combinations, apply turns them into formula strings</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(<span class="fu">combn</span>(x_vars, p), <span class="dv">2</span>, <span class="cf">function</span>(vars) {</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(y_var, <span class="st">" ~ "</span>, <span class="fu">paste</span>(vars, <span class="at">collapse =</span> <span class="st">" + "</span>))</span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co">#get the name of the features</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>features_name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(features_data[<span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>]) <span class="sc">%&gt;%</span> <span class="fu">as.character</span>()</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">generate_formulas</span>(<span class="at">p=</span><span class="dv">6</span>, <span class="co">#number of predictors</span></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x_vars=</span>features_name,</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y_var=</span> <span class="st">"track_popularity"</span>)</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a><span class="co"># have a look in the 6 first formulas</span></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(formulas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "track_popularity ~ energy + tempo + danceability + liveness + loudness + valence"         
[2] "track_popularity ~ energy + tempo + danceability + liveness + loudness + speechiness"     
[3] "track_popularity ~ energy + tempo + danceability + liveness + loudness + instrumentalness"
[4] "track_popularity ~ energy + tempo + danceability + liveness + loudness + mode"            
[5] "track_popularity ~ energy + tempo + danceability + liveness + loudness + key"             
[6] "track_popularity ~ energy + tempo + danceability + liveness + loudness + acousticness"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#how many formulas have we?</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>length_formulas <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let’s create a function to get the MSE of the linear regessions applied on the validation set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create MSE function</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>lm_mse <span class="ot">&lt;-</span> <span class="cf">function</span>(formula, train_data, val_data) {</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  y_name <span class="ot">&lt;-</span> <span class="fu">as.character</span>(formula)[<span class="dv">2</span>]</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  y_true <span class="ot">&lt;-</span> val_data[[y_name]]</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(formula, train_data)</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, <span class="at">newdata =</span> val_data)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>((y_true <span class="sc">-</span> y_pred)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a><span class="co">#create a vector for MSE values</span></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>mses6 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,length_formulas)</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>length_formulas){</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a> mses6[i] <span class="ot">&lt;-</span> <span class="fu">lm_mse</span>(<span class="fu">as.formula</span>(formulas[i]), train_data, val_data)</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>six_pred <span class="ot">&lt;-</span>formulas[<span class="fu">which.min</span>(mses6)]</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>six_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "track_popularity ~ energy + danceability + liveness + loudness + speechiness + duration_min"</code></pre>
</div>
</div>
<p>And now the same procedure for the five and four best predictors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">generate_formulas</span>(<span class="at">p=</span><span class="dv">5</span>, <span class="co">#number of predictors</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x_vars=</span>features_name,</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y_var=</span> <span class="st">"track_popularity"</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>length_formulas <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>mses5 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,length_formulas)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>length_formulas){</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a> mses5[i] <span class="ot">&lt;-</span> <span class="fu">lm_mse</span>(<span class="fu">as.formula</span>(formulas[i]), train_data, val_data)</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb109-11"><a href="#cb109-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-12"><a href="#cb109-12" aria-hidden="true" tabindex="-1"></a>five_pred <span class="ot">&lt;-</span>formulas[<span class="fu">which.min</span>(mses5)]</span>
<span id="cb109-13"><a href="#cb109-13" aria-hidden="true" tabindex="-1"></a>five_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "track_popularity ~ energy + danceability + loudness + speechiness + duration_min"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">generate_formulas</span>(<span class="at">p=</span><span class="dv">4</span>, <span class="co">#number of predictors</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">x_vars=</span>features_name,</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">y_var=</span> <span class="st">"track_popularity"</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>length_formulas <span class="ot">&lt;-</span> <span class="fu">length</span>(formulas)</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>mses4 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,length_formulas)</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>length_formulas){</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a> mses4[i] <span class="ot">&lt;-</span> <span class="fu">lm_mse</span>(<span class="fu">as.formula</span>(formulas[i]), train_data, val_data)</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>four_pred <span class="ot">&lt;-</span>formulas[<span class="fu">which.min</span>(mses4)]</span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>four_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "track_popularity ~ loudness + valence + speechiness + duration_min"</code></pre>
</div>
</div>
<p>Seems like the energy, the loudness, the speechiness and the duration are important factors in all the models.</p>
<p>And which of the models has the smallest MSE on the validation set?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="st">"MSE of the four predictor model"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MSE of the four predictor model"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mses4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="st">"MSE of the five predictor model"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MSE of the five predictor model"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mses5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="st">"MSE of the dix predictor model"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "MSE of the dix predictor model"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(mses6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 28.5</code></pre>
</div>
</div>
<p>Interesting! All of the models have the same MSE and it’s quite high! To do this for all possible combinations could be a bit cumbersome and needs a lot of computational power. Intead, we could use a lasso regression, what is a good option, when a relatively small number of predictors have substantial coefficients like in this regression. For more infos about LASSO see this <a href="https://bookdown.org/ssjackson300/Machine-Learning-Lecture-Notes/the-lasso.html#disadvantage-of-ridge-regression">Chapter</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create model matrix</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>x_train <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(track_popularity <span class="sc">~</span> ., <span class="at">data=</span>train_data)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   (Intercept) energy tempo danceability liveness loudness valence speechiness
1            1  0.592 158.0        0.521   0.1220    -7.78   0.535      0.0304
4            1  0.910 113.0        0.670   0.3040    -4.07   0.786      0.0634
7            1  0.561 150.1        0.669   0.0954    -6.54   0.841      0.0411
8            1  0.247 148.1        0.467   0.1700   -12.00   0.126      0.0431
9            1  0.416  94.9        0.492   0.2030   -10.44   0.297      0.0254
10           1  0.722 120.0        0.769   0.1110    -5.49   0.570      0.0507
   instrumentalness mode key acousticness duration_min
1        0.00000000    0   6       0.3080         4.19
4        0.00000000    0   0       0.0939         2.62
7        0.00962000    1  10       0.4950         2.83
8        0.00027100    0   6       0.6120         4.36
9        0.00008610    1  11       0.6860         3.53
10       0.00000256    0  11       0.0584         4.27</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's do a lasso regression</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">glmnet</span>(<span class="at">x      =</span> x_train[, <span class="sc">-</span><span class="dv">1</span>],          <span class="co"># X matrix without intercept</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">y      =</span> train_data<span class="sc">$</span>track_popularity, </span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">alpha =</span><span class="dv">1</span> )                      <span class="co"># using k-fold validation to tune lambda</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">xvar=</span><span class="st">'lambda'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Overall, we have 12 predictors included.</p>
<p>That gives good insights, at which lambda another or multiple predictors are set to zero.</p>
<p>A better way to use lambda is to use cross-validation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>x_cv <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(track_popularity <span class="sc">~</span> ., <span class="fu">bind_rows</span>(train_data, val_data))[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>result_cv <span class="ot">&lt;-</span> <span class="fu">cv.glmnet</span>(<span class="at">x =</span> x_cv, <span class="at">y =</span> <span class="fu">c</span>(train_data<span class="sc">$</span>track_popularity, val_data<span class="sc">$</span>track_popularity), <span class="at">nfolds =</span> <span class="dv">15</span>)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>best_lambda <span class="ot">&lt;-</span> result_cv<span class="sc">$</span>lambda.min</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>best_lambda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.083</code></pre>
</div>
</div>
<p>Which coefficients are part of the minimum lambda value?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coef</span>(result_cv, <span class="at">s =</span> <span class="st">'lambda.min'</span>)),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>13 x 1 sparse Matrix of class "dgCMatrix"
                     s1
(Intercept)      80.355
energy           -1.749
tempo             .    
danceability     -0.620
liveness          .    
loudness          0.149
valence          -0.172
speechiness      -9.216
instrumentalness -1.019
mode              .    
key              -0.001
acousticness     -0.068
duration_min     -0.423</code></pre>
</div>
</div>
<p>The best model according to this lasso regression is without the tempo and the mode features.</p>
<p>Let’s assess the performance of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model 1</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mse</span>(test_data<span class="sc">$</span>track_popularity, <span class="fu">predict</span>(model_lm1, test_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 34.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># best subset of four</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>pred_sub <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="fu">lm</span>(four_pred, <span class="at">data =</span> train_data),<span class="at">newdata =</span> test_data)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mse</span>(test_data<span class="sc">$</span>track_popularity, pred_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cv.lasso</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(track_popularity <span class="sc">~</span> ., <span class="at">data =</span> test_data)[, <span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>pred_las <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(result_cv, <span class="at">newx=</span>test, <span class="at">s=</span>best_lambda))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mse</span>(test_data<span class="sc">$</span>track_popularity, pred_las)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35.1</code></pre>
</div>
</div>
<p>Overall, we could see the linear regression models have a very bad MSE. We can do better than that ! Most of the relationsships in the data aren’t linear, because it’s more about the sweet spot!</p>
</section>
<section id="beyond-linearity" class="level2">
<h2 class="anchored" data-anchor-id="beyond-linearity">Beyond linearity</h2>
<p>Now, we investigate the features one by one in order to identify, how they are connected to the popularity.</p>
<p>For better visualization, the following function is helpful:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>pred_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(model) { <span class="co">#defines the function, needs model as an argument</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  x_pred <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(train_data<span class="sc">$</span>energy), <span class="fu">max</span>(train_data<span class="sc">$</span>energy), <span class="at">length.out =</span> <span class="dv">986</span>) <span class="co"># set the x value for pred from the lowest lstat value to the highest. We now get a vector with 500 values from the lowest lstat to the highest. The numbers are generated randomly, so we have simulated data.</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  y_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> <span class="fu">tibble</span>(<span class="at">energy =</span> x_pred)) <span class="co">#we predict the numeric outcome for y based on model we have defined and use for the prediction the randomly generated data x_pred</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  train_data <span class="sc">%&gt;%</span> <span class="co">#we set the data that we want to use</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> energy, <span class="at">y =</span> track_popularity)) <span class="sc">+</span> <span class="co">#we define the asthetics and map them</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span> <span class="fl">0.7</span>, <span class="at">color=</span> <span class="st">"steelblue4"</span>) <span class="sc">+</span> <span class="co">#we want a scatterplot, so we define the associated geom</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">energy =</span> x_pred, <span class="at">track_popularity =</span> y_pred), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"purple"</span>) <span class="sc">+</span> <span class="co">#we add a line for the predicted y on the predicted x data</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_own</span>() <span class="co"># we define a nice theme</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A four-degree polynomial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>poly3_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(track_popularity <span class="sc">~</span><span class="fu">poly</span>(energy,<span class="dv">5</span>), <span class="at">data=</span>train_data)</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pred_plot</span>(poly3_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>For a model with splines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">#for the knots</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>ns_mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(track_popularity <span class="sc">~</span> <span class="fu">bs</span>(energy, <span class="at">df=</span><span class="dv">2</span>, <span class="at">knots=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="fl">0.8</span>)), <span class="at">data=</span> train_data)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pred_plot</span>(ns_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/EddaBra\.github\.io\/popular-spotify-tracks\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>